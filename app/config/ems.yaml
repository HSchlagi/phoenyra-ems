bess:
  efficiency_charge: 0.95
  efficiency_discharge: 0.95
  energy_capacity_kwh: 200.0
  power_charge_max_kw: 100.0
  power_discharge_max_kw: 100.0
  soc_max_percent: 90.0
  soc_min_percent: 10.0
database:
  history_path: data/ems_history.db
ems:
  mode: auto
  optimization_interval_minutes: 15
  timestep_s: 2
feedin_limitation:
  dynamic_rules: []
  enabled: true
  fixed_limit_pct: 70
  mode: fixed
  pv_forecast_integration: true
forecast:
  demo_mode: true
  latitude: 48.2082
  load_forecast_method: simple
  longitude: 16.3738
  openweathermap_api_key: null
  pv_efficiency: 0.85
  pv_forecast_method: simple
  pv_peak_power_kw: 50.0
  use_prophet: false
  use_weather: false
grid_connection:
  max_power_kw: 30
  monitoring:
    enabled: true
modbus:
  connection_type: tcp
  enabled: false
  host: localhost
  poll_interval_s: 2.0
  port: 502
  profile: hithium_ess_5016
  registers:
    current_a:
      address: 3
      category: telemetry
      count: 1
      data_type: uint16
      description: Systemstrom (positiv = Laden, negativ = Entladen)
      function: 4
      offset: -3200.0
      scale: 0.1
      signed: false
      unit: A
      zero_based: false
    ems_comm_fault:
      address: 47
      category: diagnostics
      count: 1
      data_type: uint16
      description: Kommunikation EMS <-> BMS (0=OK, 1=Fehler)
      function: 4
      offset: 0.0
      scale: 1.0
      signed: false
      zero_based: false
    insulation_resistance_kohm:
      address: 45
      category: diagnostics
      count: 1
      data_type: uint16
      description: System-Isolationswiderstand
      function: 4
      offset: 0.0
      scale: 1.0
      signed: false
      unit: kOhm
      zero_based: false
    max_charge_current_a:
      address: 35
      category: limit
      count: 1
      data_type: uint16
      description: Zul채ssiger maximaler Ladestrom
      function: 4
      offset: 0.0
      scale: 0.1
      signed: false
      unit: A
      zero_based: false
    max_charge_power_kw:
      address: 33
      category: limit
      count: 1
      data_type: uint16
      description: Zul채ssige maximale Ladeleistung
      function: 4
      offset: 0.0
      scale: 0.1
      signed: false
      unit: kW
      zero_based: false
    max_discharge_current_a:
      address: 34
      category: limit
      count: 1
      data_type: uint16
      description: Zul채ssiger maximaler Entladestrom
      function: 4
      offset: 0.0
      scale: 0.1
      signed: false
      unit: A
      zero_based: false
    max_discharge_power_kw:
      address: 32
      category: limit
      count: 1
      data_type: uint16
      description: Zul채ssige maximale Entladeleistung
      function: 4
      offset: 0.0
      scale: 0.1
      signed: false
      unit: kW
      zero_based: false
    pcs_comm_fault:
      address: 46
      category: diagnostics
      count: 1
      data_type: uint16
      description: Kommunikation PCS <-> BMS (0=OK, 1=Fehler)
      function: 4
      offset: 0.0
      scale: 1.0
      signed: false
      zero_based: false
    soc_percent:
      address: 4
      category: telemetry
      count: 1
      data_type: uint16
      description: System State of Charge
      function: 4
      offset: 0.0
      scale: 1.0
      signed: false
      unit: '%'
      zero_based: false
    soh_percent:
      address: 5
      category: telemetry
      count: 1
      data_type: uint16
      description: System State of Health
      function: 4
      offset: 0.0
      scale: 1.0
      signed: false
      unit: '%'
      zero_based: false
    status_code:
      address: 43
      category: status
      count: 1
      data_type: uint16
      description: Systemstatus laut BMS
      function: 4
      offset: 0.0
      scale: 1.0
      signed: false
      zero_based: false
    temperature_c:
      address: 42
      category: telemetry
      count: 1
      data_type: uint16
      description: Durchschnittliche Systemtemperatur
      function: 4
      offset: -40.0
      scale: 1.0
      signed: false
      unit: C
      zero_based: false
    voltage_v:
      address: 2
      category: telemetry
      count: 1
      data_type: uint16
      description: System-Gesamtspannung
      function: 4
      offset: 0.0
      scale: 0.1
      signed: false
      unit: V
      zero_based: false
  retries: 3
  slave_id: 1
  status_codes:
    '0': Initialisierung
    '1': Laden
    '2': Entladen
    '3': Bereit
    '5': Ladesperre
    '6': Entladesperre
    '7': Lade- & Entladesperre
    '8': Fehler
  timeout: 3.0
mqtt:
  broker_host: 192.168.1.73
  broker_port: 1883
  client_id: phoenyra_ems
  enabled: true
  keepalive: 60
  password: 1965_e
  qos: 1
  topics:
    publish:
      alerts: ems/alerts
      bess: bess/data
      optimization: ems/optimization
      status: ems/status
    subscribe:
      commands: ems/commands
      config: ems/config
      setpoints: ems/setpoints
      strategy: ems/strategy_override
      telemetry: homeassistant/sensor/MSA-280024210086/quick/state
  username: mqtt
power_control:
  auto_write: false
  enabled: false
  max_power_kw: 500.0
  signals:
    dso_limit_pct:
      max_pct: 100
      min_pct: 0
      register: active_power_limit_pct
      scale: 0.1
    dso_trip:
      mask: 4
      register: status_word
    safety_alarm:
      mask: 1
      register: alarm_word
  writes:
    active_power_limit_pct:
      register: active_power_limit_pct
      scale: 0.1
    active_power_set_w:
      register: active_power_set_w
      scale: 1.0
    remote_enable:
      register: remote_enable
      true: 1
      false: 0
prices:
  demo_mode: false
  provider: awattar
  region: AT
sites:
  db_path: ../data/ems.db
  default_site_id: 1
strategies:
  arbitrage:
    min_price_spread: 20.0
    min_profit_threshold: 5.0
  load_balancing:
    smoothing_window: 3
    target_load_factor: 0.8
  manual_strategy: arbitrage
  peak_shaving:
    peak_threshold_percentile: 75
    target_peak_reduction: 20
  selection_mode: auto
  self_consumption:
    feedin_tariff: 0.08
    grid_tariff: 0.3
  switch_threshold: 0.15
