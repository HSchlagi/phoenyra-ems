<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Phoenyra EMS{% endblock %}</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    {% block head %}{% endblock %}
</head>
<body>
    <!-- Navigation -->
    {% if session.user %}
    <nav>
        <div class="nav-container">
            <div style="display: flex; align-items: center; gap: 32px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <img src="{{ url_for('static', filename='logo/Phoenyra_Abstract.png') }}" 
                         alt="Phoenyra Logo" 
                         style="width: 56px; height: 56px; object-fit: contain; filter: brightness(1.3) drop-shadow(0 0 8px rgba(59, 130, 246, 0.4));"
                         onerror="this.style.display='none'">
                    <span class="nav-brand" style="font-size: 20px; font-weight: 800;">Phoenyra EMS</span>
                </div>
                <div class="nav-links">
                    <a href="{{ url_for('web.dashboard') }}" class="nav-link {{ 'active' if request.path == '/' else '' }}">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                        </svg>
                        Dashboard
                    </a>
                    <a href="{{ url_for('web.monitoring') }}" class="nav-link {{ 'active' if request.path == '/monitoring' else '' }}">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1H4a1 1 0 01-1-1V4zm6 3a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1h-2a1 1 0 01-1-1V7zm6-5a1 1 0 00-1 1v14a1 1 0 001 1h2a1 1 0 001-1V3a1 1 0 00-1-1h-2z"></path>
                        </svg>
                        Monitoring
                    </a>
                    <a href="{{ url_for('web.analytics') }}" class="nav-link {{ 'active' if request.path == '/analytics' else '' }}">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                        </svg>
                        Analytics
                    </a>
                    <a href="{{ url_for('web.forecasts') }}" class="nav-link {{ 'active' if request.path == '/forecasts' else '' }}">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd"></path>
                        </svg>
                        Prognosen
                    </a>
                    <a href="{{ url_for('web.settings') }}" class="nav-link {{ 'active' if request.path == '/settings' else '' }}">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                        </svg>
                        Einstellungen
                    </a>
                </div>
            </div>
            <div class="nav-user">
                <div class="user-badge">
                    <svg fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
                    </svg>
                    {{ session.user.name }}
                </div>
                <a href="{{ url_for('web.logout') }}" class="logout-btn">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                    </svg>
                    Logout
                </a>
                <div class="datetime-display" id="datetime-display" style="font-family: 'Courier New', monospace; font-size: 14px; color: #94a3b8;">
                    <div id="date"></div>
                    <div id="time"></div>
                </div>
            </div>
        </div>
    </nav>
    {% endif %}
    
    <main>
        {% block content %}{% endblock %}
    </main>
    
    <!-- Footer -->
    <footer style="background: #1e293b; border-top: 1px solid #ffd700; padding: 20px 40px; margin-top: 24px;">
      <div style="display: flex; justify-content: space-between; align-items: center; max-width: 100%; color: #94a3b8; font-size: 14px;">
        <span>Phoenyra BESS EMS v2.0</span>
        <span>Â© 2025 Phoenyra.com by Ing. Heinz Schlagintweit. Alle Rechte vorbehalten.</span>
      </div>
    </footer>
    
    {% block scripts %}{% endblock %}
    <script>
        // Update Datum und Zeit
        function updateDateTime() {
            const now = new Date();
            
            // Datum formatieren: DD.MM.YYYY
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const dateStr = `${day}.${month}.${year}`;
            
            // Zeit formatieren: HH:MM:SS
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const timeStr = `${hours}:${minutes}:${seconds}`;
            
            // Anzeige aktualisieren
            const dateElem = document.getElementById('date');
            const timeElem = document.getElementById('time');
            if (dateElem) dateElem.textContent = dateStr;
            if (timeElem) timeElem.textContent = timeStr;
        }
        
        // Sofort aktualisieren und dann jede Sekunde
        updateDateTime();
        setInterval(updateDateTime, 1000);
    </script>
</body>
</html>
