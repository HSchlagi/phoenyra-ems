<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Phoenyra EMS</title>
  <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
  <script>
    // Prevent any flash: Hide logo icon until image is confirmed loaded
    (function() {
      // Immediately hide logo icon
      const style = document.createElement('style');
      style.textContent = '.logo-icon { opacity: 0 !important; }';
      document.head.appendChild(style);
      
      const logoImg = new Image();
      const logoPath = "{{ url_for('static', filename='logo/Phoenyra_Abstract.png') }}";
      
      // Preload the logo image
      logoImg.src = logoPath;
      
      // Once image is loaded, show logo smoothly
      logoImg.onload = function() {
        requestAnimationFrame(function() {
          document.body.classList.add('loaded');
          // Remove the inline style that hides the icon
          style.remove();
        });
      };
      
      // If image fails, still show after a moment
      logoImg.onerror = function() {
        setTimeout(function() {
          document.body.classList.add('loaded');
          style.remove();
        }, 100);
      };
      
      // Fallback timeout
      setTimeout(function() {
        if (!document.body.classList.contains('loaded')) {
          document.body.classList.add('loaded');
          style.remove();
        }
      }, 500);
    })();
  </script>
</head>
<body>
  
  <div class="container">
    <div class="card">
      
      <!-- Logo -->
      <div class="logo">
        <div class="logo-icon">
          <img src="{{ url_for('static', filename='logo/Phoenyra_Abstract.png') }}" 
               alt="Phoenyra Logo" 
               class="logo-image"
               loading="eager"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <svg class="logo-fallback" viewBox="0 0 24 24" fill="white" aria-hidden="true">
            <path d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"/>
          </svg>
        </div>
        <h1>Phoenyra EMS</h1>
        <p>Intelligentes Energiemanagementsystem</p>
      </div>

      <!-- Error -->
      {% if error %}
      <div class="error">
        {{ error }}
      </div>
      {% endif %}

      <!-- Form -->
      <form method="POST">
        <div class="form-group">
          <label>E-Mail-Adresse</label>
          <input type="email" name="username" placeholder="ihre.email@beispiel.de" required autofocus>
        </div>

        <div class="form-group">
          <label>Passwort</label>
          <input type="password" name="password" placeholder="Passwort eingeben" required>
        </div>

        <button type="submit">Anmelden</button>
      </form>

      <!-- Registrierung Link -->
      <div style="margin-top: 24px; text-align: center; padding-top: 24px; border-top: 1px solid rgba(71, 85, 105, 0.5);">
        <p style="color: #94a3b8; font-size: 14px; margin-bottom: 12px;">
          Noch kein Konto?
        </p>
        <a href="{{ url_for('web.register') }}" 
           style="display: inline-block; padding: 12px 24px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 10px; color: #60a5fa; text-decoration: none; font-size: 14px; font-weight: 600; transition: all 0.3s ease;">
          Jetzt registrieren
        </a>
      </div>

    </div>

    <!-- Footer -->
    <div class="footer" style="display: flex; justify-content: space-between; align-items: center; width: 100%; flex-wrap: wrap; gap: 8px;">
      <span>Phoenyra BESS EMS v2.0</span>
      <span>Â© 2025 Phoenyra.com by Ing. Heinz Schlagintweit. Alle Rechte vorbehalten.</span>
    </div>
  </div>

</body>
</html>
